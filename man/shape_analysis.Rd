% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/shape_analysis.R
\name{shape_analysis}
\alias{shape_analysis}
\title{Analyze Shape Images and Perform PCA}
\usage{
shape_analysis(
  shape_dir,
  norm = TRUE,
  output_file = "shape_analysis.xlsx",
  num_pcs = 10,
  start_point = "left"
)
}
\arguments{
\item{shape_dir}{A character string specifying the directory containing shape files
(images in JPG format). The directory must exist and contain at least one valid JPG file.}

\item{norm}{Logical. Should the Fourier descriptors be normalized? If TRUE, shapes are
normalized to the first harmonic. If FALSE, shapes are normalized to the longest radius. Default is TRUE.}

\item{output_file}{A character string specifying the path to the Excel file where PCA scores will
be saved. Default is "shape_analysis.xlsx".}

\item{num_pcs}{Integer. The number of principal components to display in the PC contribution plot. Default is 10.}

\item{start_point}{A character string specifying the starting point for alignment during shape normalization.
Options are \code{"up"}, \code{"left"}, \code{"down"}, or \code{"right"}. Default is \code{"left"}.}
}
\value{
A character string indicating the file path where PCA scores were successfully saved.
Additionally, a plot of PC contributions for the specified number of principal components is displayed.
}
\description{
This function processes a directory of shape images, normalizes the shapes,
performs Elliptical Fourier Analysis (EFA) and Principal Component Analysis (PCA),
displays a plot of PC contributions, and saves PCA scores to an Excel file.
}
\details{
The function uses the \code{Momocs} package to import, normalize, and analyze shape outlines:
\itemize{
\item \strong{Normalization}: The shapes are centered, scaled, and aligned to a consistent orientation.
\item \strong{Elliptical Fourier Analysis (EFA)}: Generates Fourier descriptors for the shape outlines.
\item \strong{Principal Component Analysis (PCA)}: Decomposes the Fourier descriptors into principal components.
}

PCA scores for all analyzed shapes are saved to an Excel file. A plot of the contributions of the specified
number of principal components is displayed.
}
\section{Dependencies}{

This function requires the following R packages:
\itemize{
\item \pkg{Momocs} for shape analysis.
\item \pkg{openxlsx} for writing PCA scores to an Excel file.
}
}

\examples{
\dontrun{
# Analyze shape images in a directory and save results
shape_analysis(
  shape_dir = "path/to/shape/directory",
  norm = TRUE,
  output_file = "shape_analysis_results.xlsx",
  num_pcs = 5,
  start_point = "down"
)
}

}
